library(tidyverse)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(car)
library(psych)
library(ggthemes)

share_data <- read.csv("share_selected.csv")
share_data1 <- share_data |> select(-age_partner)

# Build a regression model using backward selection
## All predictors included

model_all <- share_data1 |>
  lm(formula = household_income ~ .)
summary(model_all)
vif(model_all)

### Select model
model_allminus2 <- share_data1 |>
  lm(formula = household_income ~ . - age)
summary(model_allminus2)

model_allminus3 <- share_data1 |>
  lm(formula = household_income ~ . - age - years_of_education)
summary(model_allminus3)

model_allminus4 <- share_data1 |>
  lm(formula = household_income ~ . - age - years_of_education - sex)
summary(model_allminus4)

model_allminus5 <- share_data1 |>
  lm(formula = household_income ~ . - age - years_of_education - sex - relative_math_ability_at_age_10)
summary(model_allminus5)

model_final1 <- share_data1 |>
  lm(formula = household_income ~ n_household + retired + books_age_10 + relative_language_ability_at_age_10)
summary(model_final1)
### Residual standard error: 17580 on 415 degrees of freedomMultiple R-squared:  0.2423,	Adjusted R-squared:  0.235 F-statistic: 33.18 on 4 and 415 DF,  p-value: < 2.2e-16